# OpenClawå‘½ä»¤è¡Œé£æ ¼ç½‘ç«™ - éƒ¨ç½²æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªé‡‡ç”¨OpenClawå‘½ä»¤è¡Œç•Œé¢é£æ ¼çš„Reactç½‘ç«™ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- ğŸ–¥ï¸ **ç»ˆç«¯é£æ ¼ç•Œé¢**ï¼šæ¨¡æ‹Ÿå‘½ä»¤è¡Œ/ç»ˆç«¯ç•Œé¢
- âš¡ **ç°ä»£æŠ€æœ¯æ ˆ**ï¼šReact 18 + Vite 5
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šDocker + Nginx
- ğŸ”’ **ç”Ÿäº§çº§å®‰å…¨**ï¼šHTTPSè‡ªåŠ¨é‡å®šå‘
- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šé€‚é…å„ç§å±å¹•å°ºå¯¸

## é¡¹ç›®ç»“æ„

```
army-yorozuya/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ App.jsx            # ä¸»ç»„ä»¶ï¼ˆå‘½ä»¤è¡Œé£æ ¼ï¼‰
â”‚   â””â”€â”€ App.css            # ç»ˆç«¯é£æ ¼æ ·å¼
â”œâ”€â”€ deploy/                # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ Dockerfile         # Dockeré•œåƒæ„å»º
â”‚   â”œâ”€â”€ docker-compose.yml # å®¹å™¨ç¼–æ’
â”‚   â”œâ”€â”€ nginx/             # Nginxé…ç½®
â”‚   â”‚   â””â”€â”€ nginx.conf     # Nginxä¸»é…ç½®
â”‚   â”œâ”€â”€ deploy.sh          # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ README.md          # éƒ¨ç½²æ–‡æ¡£
â”œâ”€â”€ dist/                  # æ„å»ºè¾“å‡ºç›®å½•
â””â”€â”€ package.json          # é¡¹ç›®é…ç½®
```

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Node.js 16+ å’Œ npm
- Docker å’Œ Docker Compose
- Gitï¼ˆå¯é€‰ï¼‰

### 2. éƒ¨ç½²æ­¥éª¤

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# è¿›å…¥éƒ¨ç½²ç›®å½•
cd projects/army-yorozuya/deploy

# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# æ„å»ºå‰ç«¯
./deploy.sh build

# éƒ¨ç½²åˆ°Docker
./deploy.sh deploy

# æŸ¥çœ‹çŠ¶æ€
./deploy.sh status
```

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. æ„å»ºå‰ç«¯
cd projects/army-yorozuya
npm install
npm run build

# 2. å¤åˆ¶æ„å»ºæ–‡ä»¶
mkdir -p deploy/dist
cp -r dist/* deploy/dist/

# 3. æ„å»ºå¹¶å¯åŠ¨Dockerå®¹å™¨
cd deploy
docker-compose up -d
```

### 3. è®¿é—®ç½‘ç«™

éƒ¨ç½²æˆåŠŸåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **HTTP**: http://localhost (è‡ªåŠ¨é‡å®šå‘åˆ°HTTPS)
- **HTTPS**: https://localhost

**æ³¨æ„**ï¼šé¦–æ¬¡è®¿é—®HTTPSå¯èƒ½ä¼šæç¤ºè¯ä¹¦ä¸å®‰å…¨ï¼Œè¿™æ˜¯æ­£å¸¸çš„è‡ªç­¾åè¯ä¹¦è­¦å‘Šã€‚

## éƒ¨ç½²è„šæœ¬åŠŸèƒ½

éƒ¨ç½²è„šæœ¬ `deploy.sh` æä¾›ä»¥ä¸‹å‘½ä»¤ï¼š

| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `build` | æ„å»ºå‰ç«¯é¡¹ç›® | `./deploy.sh build` |
| `deploy` | éƒ¨ç½²åˆ°Docker | `./deploy.sh deploy` |
| `stop` | åœæ­¢å®¹å™¨ | `./deploy.sh stop` |
| `restart` | é‡å¯å®¹å™¨ | `./deploy.sh restart` |
| `status` | æŸ¥çœ‹çŠ¶æ€ | `./deploy.sh status` |
| `logs` | æŸ¥çœ‹æ—¥å¿— | `./deploy.sh logs` |
| `clean` | æ¸…ç†æ„å»ºæ–‡ä»¶ | `./deploy.sh clean` |
| `help` | æ˜¾ç¤ºå¸®åŠ© | `./deploy.sh help` |

## æŠ€æœ¯ç‰¹æ€§

### å‰ç«¯æŠ€æœ¯æ ˆ
- **React 18**: ç°ä»£å‰ç«¯æ¡†æ¶
- **Vite 5**: æé€Ÿæ„å»ºå·¥å…·
- **CSS3**: ç»ˆç«¯é£æ ¼æ ·å¼è®¾è®¡
- **å“åº”å¼è®¾è®¡**: é€‚é…ç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯

### éƒ¨ç½²æ¶æ„
- **Nginx**: é«˜æ€§èƒ½WebæœåŠ¡å™¨
- **Docker**: å®¹å™¨åŒ–éƒ¨ç½²
- **è‡ªç­¾åSSL**: å¼€å‘ç¯å¢ƒHTTPSæ”¯æŒ
- **å¥åº·æ£€æŸ¥**: å®¹å™¨å¥åº·çŠ¶æ€ç›‘æ§

### å®‰å…¨ç‰¹æ€§
- **HTTPSå¼ºåˆ¶é‡å®šå‘**: æ‰€æœ‰HTTPè¯·æ±‚é‡å®šå‘åˆ°HTTPS
- **å®‰å…¨å¤´è®¾ç½®**: CSPã€HSTSç­‰å®‰å…¨å¤´
- **æ–‡ä»¶æƒé™æ§åˆ¶**: ä¸¥æ ¼çš„ç›®å½•æƒé™è®¾ç½®
- **éšè—æ–‡ä»¶ä¿æŠ¤**: ç¦æ­¢è®¿é—®.å¼€å¤´çš„æ–‡ä»¶

## é…ç½®è¯´æ˜

### Nginxé…ç½®
é…ç½®æ–‡ä»¶ä½äº `deploy/nginx/nginx.conf`ï¼Œä¸»è¦é…ç½®ï¼š

1. **ç«¯å£ç›‘å¬**: 80(HTTP)å’Œ443(HTTPS)
2. **SSLè¯ä¹¦**: è‡ªç­¾åè¯ä¹¦ï¼Œä½äº `/etc/nginx/ssl/`
3. **ç¼“å­˜ç­–ç•¥**: é™æ€æ–‡ä»¶é•¿æœŸç¼“å­˜ï¼ŒHTMLæ–‡ä»¶çŸ­æœŸç¼“å­˜
4. **å®‰å…¨å¤´**: å¤šç§å®‰å…¨å¤´ä¿æŠ¤
5. **SPAæ”¯æŒ**: æ”¯æŒReact Routerå•é¡µåº”ç”¨

### Dockeré…ç½®
- **é•œåƒ**: nginx:alpineï¼ˆè½»é‡çº§ï¼‰
- **ç«¯å£æ˜ å°„**: 80:80, 443:443
- **é‡å¯ç­–ç•¥**: unless-stopped
- **å¥åº·æ£€æŸ¥**: 30ç§’é—´éš”å¥åº·æ£€æŸ¥
- **æ—¶åŒºè®¾ç½®**: Asia/Shanghai

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Dockeræƒé™é—®é¢˜**
   ```bash
   # å°†ç”¨æˆ·æ·»åŠ åˆ°dockerç»„
   sudo usermod -aG docker $USER
   # é‡æ–°ç™»å½•ç”Ÿæ•ˆ
   ```

2. **ç«¯å£è¢«å ç”¨**
   ```bash
   # æ£€æŸ¥ç«¯å£å ç”¨
   sudo netstat -tulpn | grep :80
   sudo netstat -tulpn | grep :443
   # åœæ­¢å ç”¨è¿›ç¨‹æˆ–ä¿®æ”¹ç«¯å£
   ```

3. **SSLè¯ä¹¦è­¦å‘Š**
   - è¿™æ˜¯æ­£å¸¸çš„è‡ªç­¾åè¯ä¹¦è­¦å‘Š
   - ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨Let's Encryptç­‰å¯ä¿¡è¯ä¹¦

4. **æ„å»ºå¤±è´¥**
   ```bash
   # æ¸…ç†node_modulesé‡æ–°å®‰è£…
   rm -rf node_modules package-lock.json
   npm install
   npm run build
   ```

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
./deploy.sh logs

# æŸ¥çœ‹Nginxè®¿é—®æ—¥å¿—
docker exec army-yorozuya-nginx tail -f /var/log/nginx/access.log

# æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿—
docker exec army-yorozuya-nginx tail -f /var/log/nginx/error.log
```

## ç»´æŠ¤æŒ‡å—

### æ—¥å¸¸ç»´æŠ¤
```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
./deploy.sh status

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats army-yorozuya-nginx

# æŸ¥çœ‹ç£ç›˜ç©ºé—´
docker system df
```

### æ›´æ–°éƒ¨ç½²
```bash
# 1. æ›´æ–°ä»£ç åé‡æ–°æ„å»º
./deploy.sh build

# 2. é‡æ–°éƒ¨ç½²
./deploy.sh deploy

# æˆ–ä½¿ç”¨é‡å¯ï¼ˆå¦‚æœåªæ˜¯é…ç½®å˜æ›´ï¼‰
./deploy.sh restart
```

### å¤‡ä»½æ¢å¤
```bash
# å¤‡ä»½é…ç½®
tar -czf backup-$(date +%Y%m%d).tar.gz deploy/nginx/nginx.conf deploy/docker-compose.yml

# æ¢å¤é…ç½®
tar -xzf backup-YYYYMMDD.tar.gz
```

## æ€§èƒ½ä¼˜åŒ–

### å·²å®æ–½çš„ä¼˜åŒ–
- âœ… Gzipå‹ç¼©å¯ç”¨
- âœ… é™æ€æ–‡ä»¶ç¼“å­˜
- âœ… è¿æ¥ä¿æŒä¼˜åŒ–
- âœ… å®‰å…¨å¤´é…ç½®
- âœ… å¥åº·æ£€æŸ¥ç›‘æ§

### å¯é€‰çš„è¿›ä¸€æ­¥ä¼˜åŒ–
- CDNé›†æˆ
- è´Ÿè½½å‡è¡¡é…ç½®
- æ•°æ®åº“è¿æ¥æ± 
- ç›‘æ§å‘Šè­¦ç³»ç»Ÿ

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œæ¼”ç¤ºä½¿ç”¨ã€‚

## æ”¯æŒä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥å®¹å™¨çŠ¶æ€
3. å‚è€ƒæ•…éšœæ’é™¤ç« èŠ‚
4. è”ç³»é¡¹ç›®ç»´æŠ¤è€…